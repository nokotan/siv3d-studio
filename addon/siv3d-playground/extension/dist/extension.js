(()=>{"use strict";var e={537:(e,a,s)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.loadAdditionalAssets=a.loadInitialAssets=void 0;const t=s(496);async function o(e,a,s,o){const i=t.Uri.joinPath(e,o||s);try{await t.workspace.fs.stat(i)}catch(e){if(!(e instanceof t.FileSystemError))throw e;const o=await t.workspace.fs.readFile(t.Uri.joinPath(a,"template",s));await t.workspace.fs.writeFile(i,o)}}async function i(e,a,s,o){const i=t.Uri.joinPath(e,o||s);try{await t.workspace.fs.stat(i)}catch(e){if(!(e instanceof t.FileSystemError))throw e;const o=await fetch(t.Uri.joinPath(t.Uri.parse(a),s).toString()),r=await o.arrayBuffer();await t.workspace.fs.writeFile(i,new Uint8Array(r))}}a.loadInitialAssets=async function(e,a){const s=[];s.push(o(e,a,"README.md")),await t.workspace.fs.createDirectory(t.Uri.joinPath(e,"src")),s.push(o(e,a,"src/Main.cpp")),await t.workspace.fs.createDirectory(t.Uri.joinPath(e,"include")),await Promise.allSettled(s)},a.loadAdditionalAssets=async function(e,a){const s=[],r=t.workspace.getConfiguration("siv3d-playground").get("siv3d-assets-download-url");s.push(o(e,a,"main.html")),await t.workspace.fs.createDirectory(t.Uri.joinPath(e,".vscode")),s.push(o(e,a,".vscode/tasks.json")),s.push(i(e,r,"lib/Siv3D.wasm","Siv3D.wasm")),s.push(i(e,r,"lib/Siv3D.js","Siv3D.js")),s.push(i(e,r,"lib/Siv3D.data","Siv3D.data")),await Promise.allSettled(s),await t.workspace.fs.createDirectory(t.Uri.joinPath(e,"example")),s.push(i(e,r,"example/windmill.png")),s.push(i(e,r,"example/particle.png")),await t.workspace.fs.createDirectory(t.Uri.joinPath(e,"example/geojson")),s.push(i(e,r,"example/geojson/countries.geojson")),await t.workspace.fs.createDirectory(t.Uri.joinPath(e,"example/texture")),s.push(i(e,r,"example/texture/uv.png")),s.push(i(e,r,"example/texture/grass.jpg")),s.push(i(e,r,"example/texture/rock.jpg")),s.push(i(e,r,"example/texture/ground.jpg")),s.push(i(e,r,"example/texture/earth.jpg")),await t.workspace.fs.createDirectory(t.Uri.joinPath(e,"example/shader")),await t.workspace.fs.createDirectory(t.Uri.joinPath(e,"example/shader/essl")),s.push(i(e,r,"example/shader/essl/terrain_forward.vert")),s.push(i(e,r,"example/shader/essl/terrain_forward.frag")),s.push(i(e,r,"example/shader/essl/terrain_normal.frag")),await t.workspace.fs.createDirectory(t.Uri.joinPath(e,"example/obj")),s.push(i(e,r,"example/obj/blacksmith.obj")),s.push(i(e,r,"example/obj/mill.obj")),s.push(i(e,r,"example/obj/tree.obj")),s.push(i(e,r,"example/obj/pine.obj")),await Promise.allSettled(s)}},496:e=>{e.exports=require("vscode")}},a={};function s(t){var o=a[t];if(void 0!==o)return o.exports;var i=a[t]={exports:{}};return e[t](i,i.exports,s),i.exports}var t={};(()=>{var e=t;Object.defineProperty(e,"__esModule",{value:!0}),e.activate=void 0;const a=s(496),o=s(537);e.activate=async function(e){let s;a.workspace.getConfiguration("siv3d-playground").get("enable-siv3d-preview")||a.window.showErrorMessage("Siv3D Preview is not available in this browser tab. Please use another browser tab."),e.subscriptions.push(a.commands.registerCommand("siv3d-playground.compile.run",(async()=>{const e=new Promise(((e,a)=>{s=e}));if(a.commands.executeCommand("workbench.action.tasks.runTask","emcc build"),0===await e){const e=a.workspace.workspaceFolders&&a.workspace.workspaceFolders.length>0?a.workspace.workspaceFolders[0].uri:void 0;a.commands.executeCommand("emcc.preview.show",a.Uri.joinPath(e,"main.html"),"Siv3D Preview")}s=null}))),a.tasks.onDidEndTaskProcess((e=>{"emcc build"==e.execution.task.name&&s&&s(e.exitCode)}));const t=a.extensions.getExtension("kamenokosoft.wasm-playground");t.isActive||await t.activate();const i=t.exports.memFs;await i.restore().catch((e=>console.error(e))),i.onDidChangeFile((function(){i.backup()}));const r=a.workspace.workspaceFolders&&a.workspace.workspaceFolders.length>0?a.workspace.workspaceFolders[0]:void 0;r&&async function(e,s){const t={preview:!1},i=s.path.split("/").slice(1);try{await a.workspace.fs.stat(s)}catch(e){if(!(e instanceof a.FileSystemError))throw e;for(let e=1;e<=i.length;e++){const t=s.with({path:"/"+i.slice(0,e).join("/")});await a.workspace.fs.createDirectory(t)}}i.length>0&&"gist"===i[0]?await a.window.withProgress({location:a.ProgressLocation.Notification,title:"downloading files from GitHub Gist..."},(async e=>{const o=a.Uri.parse(`gist://${i.slice(1).join("/")}/`),r=a.extensions.getExtension("vsls-contrib.gistfs");r.isActive||await r.activate(),await a.workspace.fs.copy(o,s,{overwrite:!0});const n=await a.workspace.findFiles("**/*.cpp");n.length>0&&a.commands.executeCommand("vscode.open",n[0],t)})):(await(0,o.loadInitialAssets)(s,e.extensionUri),a.commands.executeCommand("vscode.open",a.Uri.joinPath(s,"src/Main.cpp"),t)),await(0,o.loadAdditionalAssets)(s,e.extensionUri)}(e,r.uri)}})(),module.exports=t})();
//# sourceMappingURL=extension.js.map