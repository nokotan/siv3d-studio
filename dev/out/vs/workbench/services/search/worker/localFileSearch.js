/*!--------------------------------------------------------
 * Copyright (C) Microsoft Corporation. All rights reserved.
 *--------------------------------------------------------*/(function(){var ne=["require","exports","vs/base/common/platform","vs/base/common/path","vs/base/common/strings","vs/base/common/extpath","vs/base/common/uri","vs/base/common/resources","vs/base/common/async","vs/base/common/glob","vs/base/common/map","vs/base/common/network","vs/base/common/cancellation","vs/workbench/services/search/common/getFileResults","vs/workbench/services/search/common/ignoreFile","vs/base/common/types","vs/base/common/errors","vs/base/common/event","vs/base/common/lifecycle","vs/base/common/arrays","vs/editor/common/core/range","vs/workbench/services/search/worker/localFileSearch"],ie=function(ee){for(var e=[],E=0,D=ee.length;E<D;E++)e[E]=ne[ee[E]];return e};define(ne[10],ie([0,1]),function(ee,e){"use strict";var E,D,R;Object.defineProperty(e,"__esModule",{value:!0}),e.LRUCache=e.LinkedMap=e.Touch=e.ResourceSet=e.ResourceMap=e.setToString=e.mapToString=e.getOrSet=void 0;function I(s,n,r){let h=s.get(n);return h===void 0&&(h=r,s.set(n,h)),h}e.getOrSet=I;function y(s){const n=[];return s.forEach((r,h)=>{n.push(`${h} => ${r}`)}),`Map(${s.size}) {${n.join(", ")}}`}e.mapToString=y;function U(s){const n=[];return s.forEach(r=>{n.push(r)}),`Set(${s.size}) {${n.join(", ")}}`}e.setToString=U;class d{constructor(n,r){this.uri=n,this.value=r}}class _{constructor(n,r){this[E]="ResourceMap",n instanceof _?(this.map=new Map(n.map),this.toKey=r??_.defaultToKey):(this.map=new Map,this.toKey=n??_.defaultToKey)}set(n,r){return this.map.set(this.toKey(n),new d(n,r)),this}get(n){return this.map.get(this.toKey(n))?.value}has(n){return this.map.has(this.toKey(n))}get size(){return this.map.size}clear(){this.map.clear()}delete(n){return this.map.delete(this.toKey(n))}forEach(n,r){typeof r<"u"&&(n=n.bind(r));for(const[h,v]of this.map)n(v.value,v.uri,this)}*values(){for(const n of this.map.values())yield n.value}*keys(){for(const n of this.map.values())yield n.uri}*entries(){for(const n of this.map.values())yield[n.uri,n.value]}*[(E=Symbol.toStringTag,Symbol.iterator)](){for(const[,n]of this.map)yield[n.uri,n.value]}}e.ResourceMap=_,_.defaultToKey=s=>s.toString();class S{constructor(n,r){this[D]="ResourceSet",!n||typeof n=="function"?this._map=new _(n):(this._map=new _(r),n.forEach(this.add,this))}get size(){return this._map.size}add(n){return this._map.set(n,n),this}clear(){this._map.clear()}delete(n){return this._map.delete(n)}forEach(n,r){this._map.forEach((h,v)=>n.call(r,v,v,this))}has(n){return this._map.has(n)}entries(){return this._map.entries()}keys(){return this._map.keys()}values(){return this._map.keys()}[(D=Symbol.toStringTag,Symbol.iterator)](){return this.keys()}}e.ResourceSet=S;var A;(function(s){s[s.None=0]="None",s[s.AsOld=1]="AsOld",s[s.AsNew=2]="AsNew"})(A=e.Touch||(e.Touch={}));class j{constructor(){this[R]="LinkedMap",this._map=new Map,this._head=void 0,this._tail=void 0,this._size=0,this._state=0}clear(){this._map.clear(),this._head=void 0,this._tail=void 0,this._size=0,this._state++}isEmpty(){return!this._head&&!this._tail}get size(){return this._size}get first(){return this._head?.value}get last(){return this._tail?.value}has(n){return this._map.has(n)}get(n,r=0){const h=this._map.get(n);if(!!h)return r!==0&&this.touch(h,r),h.value}set(n,r,h=0){let v=this._map.get(n);if(v)v.value=r,h!==0&&this.touch(v,h);else{switch(v={key:n,value:r,next:void 0,previous:void 0},h){case 0:this.addItemLast(v);break;case 1:this.addItemFirst(v);break;case 2:this.addItemLast(v);break;default:this.addItemLast(v);break}this._map.set(n,v),this._size++}return this}delete(n){return!!this.remove(n)}remove(n){const r=this._map.get(n);if(!!r)return this._map.delete(n),this.removeItem(r),this._size--,r.value}shift(){if(!this._head&&!this._tail)return;if(!this._head||!this._tail)throw new Error("Invalid list");const n=this._head;return this._map.delete(n.key),this.removeItem(n),this._size--,n.value}forEach(n,r){const h=this._state;let v=this._head;for(;v;){if(r?n.bind(r)(v.value,v.key,this):n(v.value,v.key,this),this._state!==h)throw new Error("LinkedMap got modified during iteration.");v=v.next}}keys(){const n=this,r=this._state;let h=this._head;const v={[Symbol.iterator](){return v},next(){if(n._state!==r)throw new Error("LinkedMap got modified during iteration.");if(h){const T={value:h.key,done:!1};return h=h.next,T}else return{value:void 0,done:!0}}};return v}values(){const n=this,r=this._state;let h=this._head;const v={[Symbol.iterator](){return v},next(){if(n._state!==r)throw new Error("LinkedMap got modified during iteration.");if(h){const T={value:h.value,done:!1};return h=h.next,T}else return{value:void 0,done:!0}}};return v}entries(){const n=this,r=this._state;let h=this._head;const v={[Symbol.iterator](){return v},next(){if(n._state!==r)throw new Error("LinkedMap got modified during iteration.");if(h){const T={value:[h.key,h.value],done:!1};return h=h.next,T}else return{value:void 0,done:!0}}};return v}[(R=Symbol.toStringTag,Symbol.iterator)](){return this.entries()}trimOld(n){if(n>=this.size)return;if(n===0){this.clear();return}let r=this._head,h=this.size;for(;r&&h>n;)this._map.delete(r.key),r=r.next,h--;this._head=r,this._size=h,r&&(r.previous=void 0),this._state++}addItemFirst(n){if(!this._head&&!this._tail)this._tail=n;else if(this._head)n.next=this._head,this._head.previous=n;else throw new Error("Invalid list");this._head=n,this._state++}addItemLast(n){if(!this._head&&!this._tail)this._head=n;else if(this._tail)n.previous=this._tail,this._tail.next=n;else throw new Error("Invalid list");this._tail=n,this._state++}removeItem(n){if(n===this._head&&n===this._tail)this._head=void 0,this._tail=void 0;else if(n===this._head){if(!n.next)throw new Error("Invalid list");n.next.previous=void 0,this._head=n.next}else if(n===this._tail){if(!n.previous)throw new Error("Invalid list");n.previous.next=void 0,this._tail=n.previous}else{const r=n.next,h=n.previous;if(!r||!h)throw new Error("Invalid list");r.previous=h,h.next=r}n.next=void 0,n.previous=void 0,this._state++}touch(n,r){if(!this._head||!this._tail)throw new Error("Invalid list");if(!(r!==1&&r!==2)){if(r===1){if(n===this._head)return;const h=n.next,v=n.previous;n===this._tail?(v.next=void 0,this._tail=v):(h.previous=v,v.next=h),n.previous=void 0,n.next=this._head,this._head.previous=n,this._head=n,this._state++}else if(r===2){if(n===this._tail)return;const h=n.next,v=n.previous;n===this._head?(h.previous=void 0,this._head=h):(h.previous=v,v.next=h),n.next=void 0,n.previous=this._tail,this._tail.next=n,this._tail=n,this._state++}}}toJSON(){const n=[];return this.forEach((r,h)=>{n.push([h,r])}),n}fromJSON(n){this.clear();for(const[r,h]of n)this.set(r,h)}}e.LinkedMap=j;class p extends j{constructor(n,r=1){super(),this._limit=n,this._ratio=Math.min(Math.max(0,r),1)}get limit(){return this._limit}set limit(n){this._limit=n,this.checkTrim()}get ratio(){return this._ratio}set ratio(n){this._ratio=Math.min(Math.max(0,n),1),this.checkTrim()}get(n,r=2){return super.get(n,r)}peek(n){return super.get(n,0)}set(n,r){return super.set(n,r,2),this.checkTrim(),this}checkTrim(){this.size>this._limit&&this.trimOld(Math.round(this._limit*this._ratio))}}e.LRUCache=p}),define(ne[5],ie([0,1,3,2,4,15]),function(ee,e,E,D,R,I){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.randomPath=e.parseLineAndColumnAware=e.indexOfPath=e.getDriveLetter=e.hasDriveLetter=e.isRootOrDriveLetter=e.sanitizeFilePath=e.isWindowsDriveLetter=e.isEqualOrParent=e.isEqual=e.isValidBasename=e.isUNC=e.getRoot=e.toPosixPath=e.toSlashes=e.isPathSeparator=void 0;function y(o){return o===47||o===92}e.isPathSeparator=y;function U(o){return o.replace(/[\\/]/g,E.posix.sep)}e.toSlashes=U;function d(o){return o.indexOf("/")===-1&&(o=U(o)),/^[a-zA-Z]:(\/|$)/.test(o)&&(o="/"+o),o}e.toPosixPath=d;function _(o,m=E.posix.sep){if(!o)return"";const b=o.length,M=o.charCodeAt(0);if(y(M)){if(y(o.charCodeAt(1))&&!y(o.charCodeAt(2))){let F=3;const G=F;for(;F<b&&!y(o.charCodeAt(F));F++);if(G!==F&&!y(o.charCodeAt(F+1))){for(F+=1;F<b;F++)if(y(o.charCodeAt(F)))return o.slice(0,F+1).replace(/[\\/]/g,m)}}return m}else if(h(M)&&o.charCodeAt(1)===58)return y(o.charCodeAt(2))?o.slice(0,2)+m:o.slice(0,2);let W=o.indexOf("://");if(W!==-1){for(W+=3;W<b;W++)if(y(o.charCodeAt(W)))return o.slice(0,W+1)}return""}e.getRoot=_;function S(o){if(!D.isWindows||!o||o.length<5)return!1;let m=o.charCodeAt(0);if(m!==92||(m=o.charCodeAt(1),m!==92))return!1;let b=2;const M=b;for(;b<o.length&&(m=o.charCodeAt(b),m!==92);b++);return!(M===b||(m=o.charCodeAt(b+1),isNaN(m)||m===92))}e.isUNC=S;const A=/[\\/:\*\?"<>\|]/g,j=/[\\/]/g,p=/^(con|prn|aux|clock\$|nul|lpt[0-9]|com[0-9])(\.(.*?))?$/i;function s(o,m=D.isWindows){const b=m?A:j;return!(!o||o.length===0||/^\s+$/.test(o)||(b.lastIndex=0,b.test(o))||m&&p.test(o)||o==="."||o===".."||m&&o[o.length-1]==="."||m&&o.length!==o.trim().length||o.length>255)}e.isValidBasename=s;function n(o,m,b){const M=o===m;return!b||M?M:!o||!m?!1:(0,R.equalsIgnoreCase)(o,m)}e.isEqual=n;function r(o,m,b,M=E.sep){if(o===m)return!0;if(!o||!m||m.length>o.length)return!1;if(b){if(!(0,R.startsWithIgnoreCase)(o,m))return!1;if(m.length===o.length)return!0;let F=m.length;return m.charAt(m.length-1)===M&&F--,o.charAt(F)===M}return m.charAt(m.length-1)!==M&&(m+=M),o.indexOf(m)===0}e.isEqualOrParent=r;function h(o){return o>=65&&o<=90||o>=97&&o<=122}e.isWindowsDriveLetter=h;function v(o,m){return D.isWindows&&o.endsWith(":")&&(o+=E.sep),(0,E.isAbsolute)(o)||(o=(0,E.join)(m,o)),o=(0,E.normalize)(o),D.isWindows?(o=(0,R.rtrim)(o,E.sep),o.endsWith(":")&&(o+=E.sep)):(o=(0,R.rtrim)(o,E.sep),o||(o=E.sep)),o}e.sanitizeFilePath=v;function T(o){const m=(0,E.normalize)(o);return D.isWindows?o.length>3?!1:N(m)&&(o.length===2||m.charCodeAt(2)===92):m===E.posix.sep}e.isRootOrDriveLetter=T;function N(o,m=D.isWindows){return m?h(o.charCodeAt(0))&&o.charCodeAt(1)===58:!1}e.hasDriveLetter=N;function Y(o){return N(o)?o[0]:void 0}e.getDriveLetter=Y;function C(o,m,b){return m.length>o.length?-1:o===m?0:(b&&(o=o.toLowerCase(),m=m.toLowerCase()),o.indexOf(m))}e.indexOfPath=C;function q(o){const m=o.split(":");let b,M,W;for(const F of m){const G=Number(F);(0,I.isNumber)(G)?M===void 0?M=G:W===void 0&&(W=G):b=b?[b,F].join(":"):F}if(!b)throw new Error("Format for `--goto` should be: `FILE:LINE(:COLUMN)`");return{path:b,line:M!==void 0?M:void 0,column:W!==void 0?W:M!==void 0?1:void 0}}e.parseLineAndColumnAware=q;const L="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";function Q(o,m,b=8){let M="";for(let F=0;F<b;F++)M+=L.charAt(Math.floor(Math.random()*L.length));let W;return m?W=`${m}-${M}`:W=M,o?(0,E.join)(o,W):W}e.randomPath=Q}),define(ne[11],ie([0,1,2,6]),function(ee,e,E,D){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.COI=e.FileAccess=e.RemoteAuthorities=e.connectionTokenQueryName=e.connectionTokenCookieName=e.Schemas=void 0;var R;(function(d){d.inMemory="inmemory",d.vscode="vscode",d.internal="private",d.walkThrough="walkThrough",d.walkThroughSnippet="walkThroughSnippet",d.http="http",d.https="https",d.file="file",d.mailto="mailto",d.untitled="untitled",d.data="data",d.command="command",d.vscodeRemote="vscode-remote",d.vscodeRemoteResource="vscode-remote-resource",d.vscodeUserData="vscode-userdata",d.vscodeCustomEditor="vscode-custom-editor",d.vscodeNotebook="vscode-notebook",d.vscodeNotebookCell="vscode-notebook-cell",d.vscodeNotebookCellMetadata="vscode-notebook-cell-metadata",d.vscodeNotebookCellOutput="vscode-notebook-cell-output",d.vscodeInteractive="vscode-interactive",d.vscodeInteractiveInput="vscode-interactive-input",d.vscodeSettings="vscode-settings",d.vscodeWorkspaceTrust="vscode-workspace-trust",d.vscodeTerminal="vscode-terminal",d.webviewPanel="webview-panel",d.vscodeWebview="vscode-webview",d.extension="extension",d.vscodeFileResource="vscode-file",d.tmp="tmp",d.vsls="vsls",d.vscodeSourceControl="vscode-scm"})(R=e.Schemas||(e.Schemas={})),e.connectionTokenCookieName="vscode-tkn",e.connectionTokenQueryName="tkn";class I{constructor(){this._hosts=Object.create(null),this._ports=Object.create(null),this._connectionTokens=Object.create(null),this._preferredWebSchema="http",this._delegate=null,this._remoteResourcesPath=`/${R.vscodeRemoteResource}`}setPreferredWebSchema(_){this._preferredWebSchema=_}setDelegate(_){this._delegate=_}setServerRootPath(_){this._remoteResourcesPath=`${_}/${R.vscodeRemoteResource}`}set(_,S,A){this._hosts[_]=S,this._ports[_]=A}setConnectionToken(_,S){this._connectionTokens[_]=S}getPreferredWebSchema(){return this._preferredWebSchema}rewrite(_){if(this._delegate)return this._delegate(_);const S=_.authority;let A=this._hosts[S];A&&A.indexOf(":")!==-1&&A.indexOf("[")===-1&&(A=`[${A}]`);const j=this._ports[S],p=this._connectionTokens[S];let s=`path=${encodeURIComponent(_.path)}`;return typeof p=="string"&&(s+=`&${e.connectionTokenQueryName}=${encodeURIComponent(p)}`),D.URI.from({scheme:E.isWeb?this._preferredWebSchema:R.vscodeRemoteResource,authority:`${A}:${j}`,path:this._remoteResourcesPath,query:s})}}e.RemoteAuthorities=new I;class y{asBrowserUri(_,S){const A=this.toUri(_,S);return A.scheme===R.vscodeRemote?e.RemoteAuthorities.rewrite(A):A.scheme===R.file&&(E.isNative||E.isWebWorker&&E.globals.origin===`${R.vscodeFileResource}://${y.FALLBACK_AUTHORITY}`)?A.with({scheme:R.vscodeFileResource,authority:A.authority||y.FALLBACK_AUTHORITY,query:null,fragment:null}):A}asFileUri(_,S){const A=this.toUri(_,S);return A.scheme===R.vscodeFileResource?A.with({scheme:R.file,authority:A.authority!==y.FALLBACK_AUTHORITY?A.authority:null,query:null,fragment:null}):A}toUri(_,S){return D.URI.isUri(_)?_:D.URI.parse(S.toUrl(_))}}y.FALLBACK_AUTHORITY="vscode-app",e.FileAccess=new y;var U;(function(d){const _=new Map([["1",{"Cross-Origin-Opener-Policy":"same-origin"}],["2",{"Cross-Origin-Embedder-Policy":"require-corp"}],["3",{"Cross-Origin-Opener-Policy":"same-origin","Cross-Origin-Embedder-Policy":"require-corp"}]]);d.CoopAndCoep=Object.freeze(_.get("3"));const S="vscode-coi";function A(p){let s;typeof p=="string"?s=new URL(p).searchParams:p instanceof URL?s=p.searchParams:D.URI.isUri(p)&&(s=new URL(p.toString(!0)).searchParams);const n=s?.get(S);if(!!n)return _.get(n)}d.getHeadersFromQuery=A;function j(p,s,n){if(!globalThis.crossOriginIsolated)return;const r=s&&n?"3":n?"2":"1";p instanceof URLSearchParams?p.set(S,r):p[S]=r}d.addSearchParam=j})(U=e.COI||(e.COI={}))}),define(ne[7],ie([0,1,5,11,3,2,4,6]),function(ee,e,E,D,R,I,y,U){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.toLocalResource=e.DataUri=e.distinctParents=e.addTrailingPathSeparator=e.removeTrailingPathSeparator=e.hasTrailingPathSeparator=e.isEqualAuthority=e.isAbsolutePath=e.resolvePath=e.relativePath=e.normalizePath=e.joinPath=e.dirname=e.extname=e.basename=e.basenameOrAuthority=e.getComparisonKey=e.isEqualOrParent=e.isEqual=e.extUriIgnorePathCase=e.extUriBiasedIgnorePathCase=e.extUri=e.ExtUri=e.originalFSPath=void 0;function d(p){return(0,U.uriToFsPath)(p,!0)}e.originalFSPath=d;class _{constructor(s){this._ignorePathCasing=s}compare(s,n,r=!1){return s===n?0:(0,y.compare)(this.getComparisonKey(s,r),this.getComparisonKey(n,r))}isEqual(s,n,r=!1){return s===n?!0:!s||!n?!1:this.getComparisonKey(s,r)===this.getComparisonKey(n,r)}getComparisonKey(s,n=!1){return s.with({path:this._ignorePathCasing(s)?s.path.toLowerCase():void 0,fragment:n?null:void 0}).toString()}ignorePathCasing(s){return this._ignorePathCasing(s)}isEqualOrParent(s,n,r=!1){if(s.scheme===n.scheme){if(s.scheme===D.Schemas.file)return E.isEqualOrParent(d(s),d(n),this._ignorePathCasing(s))&&s.query===n.query&&(r||s.fragment===n.fragment);if((0,e.isEqualAuthority)(s.authority,n.authority))return E.isEqualOrParent(s.path,n.path,this._ignorePathCasing(s),"/")&&s.query===n.query&&(r||s.fragment===n.fragment)}return!1}joinPath(s,...n){return U.URI.joinPath(s,...n)}basenameOrAuthority(s){return(0,e.basename)(s)||s.authority}basename(s){return R.posix.basename(s.path)}extname(s){return R.posix.extname(s.path)}dirname(s){if(s.path.length===0)return s;let n;return s.scheme===D.Schemas.file?n=U.URI.file(R.dirname(d(s))).path:(n=R.posix.dirname(s.path),s.authority&&n.length&&n.charCodeAt(0)!==47&&(console.error(`dirname("${s.toString})) resulted in a relative path`),n="/")),s.with({path:n})}normalizePath(s){if(!s.path.length)return s;let n;return s.scheme===D.Schemas.file?n=U.URI.file(R.normalize(d(s))).path:n=R.posix.normalize(s.path),s.with({path:n})}relativePath(s,n){if(s.scheme!==n.scheme||!(0,e.isEqualAuthority)(s.authority,n.authority))return;if(s.scheme===D.Schemas.file){const v=R.relative(d(s),d(n));return I.isWindows?E.toSlashes(v):v}let r=s.path||"/";const h=n.path||"/";if(this._ignorePathCasing(s)){let v=0;for(const T=Math.min(r.length,h.length);v<T&&!(r.charCodeAt(v)!==h.charCodeAt(v)&&r.charAt(v).toLowerCase()!==h.charAt(v).toLowerCase());v++);r=h.substr(0,v)+r.substr(v)}return R.posix.relative(r,h)}resolvePath(s,n){if(s.scheme===D.Schemas.file){const r=U.URI.file(R.resolve(d(s),n));return s.with({authority:r.authority,path:r.path})}return n=E.toPosixPath(n),s.with({path:R.posix.resolve(s.path,n)})}isAbsolutePath(s){return!!s.path&&s.path[0]==="/"}isEqualAuthority(s,n){return s===n||s!==void 0&&n!==void 0&&(0,y.equalsIgnoreCase)(s,n)}hasTrailingPathSeparator(s,n=R.sep){if(s.scheme===D.Schemas.file){const r=d(s);return r.length>E.getRoot(r).length&&r[r.length-1]===n}else{const r=s.path;return r.length>1&&r.charCodeAt(r.length-1)===47&&!/^[a-zA-Z]:(\/$|\\$)/.test(s.fsPath)}}removeTrailingPathSeparator(s,n=R.sep){return(0,e.hasTrailingPathSeparator)(s,n)?s.with({path:s.path.substr(0,s.path.length-1)}):s}addTrailingPathSeparator(s,n=R.sep){let r=!1;if(s.scheme===D.Schemas.file){const h=d(s);r=h!==void 0&&h.length===E.getRoot(h).length&&h[h.length-1]===n}else{n="/";const h=s.path;r=h.length===1&&h.charCodeAt(h.length-1)===47}return!r&&!(0,e.hasTrailingPathSeparator)(s,n)?s.with({path:s.path+"/"}):s}}e.ExtUri=_,e.extUri=new _(()=>!1),e.extUriBiasedIgnorePathCase=new _(p=>p.scheme===D.Schemas.file?!I.isLinux:!0),e.extUriIgnorePathCase=new _(p=>!0),e.isEqual=e.extUri.isEqual.bind(e.extUri),e.isEqualOrParent=e.extUri.isEqualOrParent.bind(e.extUri),e.getComparisonKey=e.extUri.getComparisonKey.bind(e.extUri),e.basenameOrAuthority=e.extUri.basenameOrAuthority.bind(e.extUri),e.basename=e.extUri.basename.bind(e.extUri),e.extname=e.extUri.extname.bind(e.extUri),e.dirname=e.extUri.dirname.bind(e.extUri),e.joinPath=e.extUri.joinPath.bind(e.extUri),e.normalizePath=e.extUri.normalizePath.bind(e.extUri),e.relativePath=e.extUri.relativePath.bind(e.extUri),e.resolvePath=e.extUri.resolvePath.bind(e.extUri),e.isAbsolutePath=e.extUri.isAbsolutePath.bind(e.extUri),e.isEqualAuthority=e.extUri.isEqualAuthority.bind(e.extUri),e.hasTrailingPathSeparator=e.extUri.hasTrailingPathSeparator.bind(e.extUri),e.removeTrailingPathSeparator=e.extUri.removeTrailingPathSeparator.bind(e.extUri),e.addTrailingPathSeparator=e.extUri.addTrailingPathSeparator.bind(e.extUri);function S(p,s){const n=[];for(let r=0;r<p.length;r++){const h=s(p[r]);p.some((v,T)=>T===r?!1:(0,e.isEqualOrParent)(h,s(v)))||n.push(p[r])}return n}e.distinctParents=S;var A;(function(p){p.META_DATA_LABEL="label",p.META_DATA_DESCRIPTION="description",p.META_DATA_SIZE="size",p.META_DATA_MIME="mime";function s(n){const r=new Map;n.path.substring(n.path.indexOf(";")+1,n.path.lastIndexOf(";")).split(";").forEach(T=>{const[N,Y]=T.split(":");N&&Y&&r.set(N,Y)});const v=n.path.substring(0,n.path.indexOf(";"));return v&&r.set(p.META_DATA_MIME,v),r}p.parseMetaData=s})(A=e.DataUri||(e.DataUri={}));function j(p,s,n){if(s){let r=p.path;return r&&r[0]!==R.posix.sep&&(r=R.posix.sep+r),p.with({scheme:n,authority:s,path:r})}return p.with({scheme:n})}e.toLocalResource=j}),define(ne[8],ie([0,1,12,16,17,18,7,2]),function(ee,e,E,D,R,I,y,U){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.createCancelableAsyncIterable=e.CancelableAsyncIterableObject=e.AsyncIterableObject=e.Promises=e.DeferredPromise=e.IntervalCounter=e.TaskSequentializer=e.retry=e.IdleValue=e.runWhenIdle=e.ThrottledWorker=e.RunOnceWorker=e.ProcessTimeRunOnceScheduler=e.RunOnceScheduler=e.IntervalTimer=e.TimeoutTimer=e.ResourceQueue=e.Queue=e.Limiter=e.firstParallel=e.first=e.sequence=e.disposableTimeout=e.timeout=e.AutoOpenBarrier=e.Barrier=e.ThrottledDelayer=e.Delayer=e.MicrotaskDelay=e.SequencerByKey=e.Sequencer=e.Throttler=e.asPromise=e.raceTimeout=e.raceCancellablePromises=e.raceCancellationError=e.raceCancellation=e.createCancelablePromise=e.isThenable=void 0;function d(l){return!!l&&typeof l.then=="function"}e.isThenable=d;function _(l){const t=new E.CancellationTokenSource,i=l(t.token),a=new Promise((u,w)=>{const B=t.token.onCancellationRequested(()=>{B.dispose(),t.dispose(),w(new D.CancellationError)});Promise.resolve(i).then(z=>{B.dispose(),t.dispose(),u(z)},z=>{B.dispose(),t.dispose(),w(z)})});return new class{cancel(){t.cancel()}then(u,w){return a.then(u,w)}catch(u){return this.then(void 0,u)}finally(u){return a.finally(u)}}}e.createCancelablePromise=_;function S(l,t,i){return new Promise((a,u)=>{const w=t.onCancellationRequested(()=>{w.dispose(),a(i)});l.then(a,u).finally(()=>w.dispose())})}e.raceCancellation=S;function A(l,t){return new Promise((i,a)=>{const u=t.onCancellationRequested(()=>{u.dispose(),a(new D.CancellationError)});l.then(i,a).finally(()=>u.dispose())})}e.raceCancellationError=A;async function j(l){let t=-1;const i=l.map((u,w)=>u.then(B=>(t=w,B))),a=await Promise.race(i);return l.forEach((u,w)=>{w!==t&&u.cancel()}),a}e.raceCancellablePromises=j;function p(l,t,i){let a;const u=setTimeout(()=>{a?.(void 0),i?.()},t);return Promise.race([l.finally(()=>clearTimeout(u)),new Promise(w=>a=w)])}e.raceTimeout=p;function s(l){return new Promise((t,i)=>{const a=l();d(a)?a.then(t,i):t(a)})}e.asPromise=s;class n{constructor(){this.activePromise=null,this.queuedPromise=null,this.queuedPromiseFactory=null}queue(t){if(this.activePromise){if(this.queuedPromiseFactory=t,!this.queuedPromise){const i=()=>{this.queuedPromise=null;const a=this.queue(this.queuedPromiseFactory);return this.queuedPromiseFactory=null,a};this.queuedPromise=new Promise(a=>{this.activePromise.then(i,i).then(a)})}return new Promise((i,a)=>{this.queuedPromise.then(i,a)})}return this.activePromise=t(),new Promise((i,a)=>{this.activePromise.then(u=>{this.activePromise=null,i(u)},u=>{this.activePromise=null,a(u)})})}}e.Throttler=n;class r{constructor(){this.current=Promise.resolve(null)}queue(t){return this.current=this.current.then(()=>t(),()=>t())}}e.Sequencer=r;class h{constructor(){this.promiseMap=new Map}queue(t,i){const u=(this.promiseMap.get(t)??Promise.resolve()).catch(()=>{}).then(i).finally(()=>{this.promiseMap.get(t)===u&&this.promiseMap.delete(t)});return this.promiseMap.set(t,u),u}}e.SequencerByKey=h;const v=(l,t)=>{let i=!0;const a=setTimeout(()=>{i=!1,t()},l);return{isTriggered:()=>i,dispose:()=>{clearTimeout(a),i=!1}}},T=l=>{let t=!0;return queueMicrotask(()=>{t&&(t=!1,l())}),{isTriggered:()=>t,dispose:()=>{t=!1}}};e.MicrotaskDelay=Symbol("MicrotaskDelay");class N{constructor(t){this.defaultDelay=t,this.deferred=null,this.completionPromise=null,this.doResolve=null,this.doReject=null,this.task=null}trigger(t,i=this.defaultDelay){this.task=t,this.cancelTimeout(),this.completionPromise||(this.completionPromise=new Promise((u,w)=>{this.doResolve=u,this.doReject=w}).then(()=>{if(this.completionPromise=null,this.doResolve=null,this.task){const u=this.task;return this.task=null,u()}}));const a=()=>{this.deferred=null,this.doResolve?.(null)};return this.deferred=i===e.MicrotaskDelay?T(a):v(i,a),this.completionPromise}isTriggered(){return!!this.deferred?.isTriggered()}cancel(){this.cancelTimeout(),this.completionPromise&&(this.doReject?.(new D.CancellationError),this.completionPromise=null)}cancelTimeout(){this.deferred?.dispose(),this.deferred=null}dispose(){this.cancel()}}e.Delayer=N;class Y{constructor(t){this.delayer=new N(t),this.throttler=new n}trigger(t,i){return this.delayer.trigger(()=>this.throttler.queue(t),i)}isTriggered(){return this.delayer.isTriggered()}cancel(){this.delayer.cancel()}dispose(){this.delayer.dispose()}}e.ThrottledDelayer=Y;class C{constructor(){this._isOpen=!1,this._promise=new Promise((t,i)=>{this._completePromise=t})}isOpen(){return this._isOpen}open(){this._isOpen=!0,this._completePromise(!0)}wait(){return this._promise}}e.Barrier=C;class q extends C{constructor(t){super(),this._timeout=setTimeout(()=>this.open(),t)}open(){clearTimeout(this._timeout),super.open()}}e.AutoOpenBarrier=q;function L(l,t){return t?new Promise((i,a)=>{const u=setTimeout(()=>{w.dispose(),i()},l),w=t.onCancellationRequested(()=>{clearTimeout(u),w.dispose(),a(new D.CancellationError)})}):_(i=>L(l,i))}e.timeout=L;function Q(l,t=0){const i=setTimeout(l,t);return(0,I.toDisposable)(()=>clearTimeout(i))}e.disposableTimeout=Q;function o(l){const t=[];let i=0;const a=l.length;function u(){return i<a?l[i++]():null}function w(B){B!=null&&t.push(B);const z=u();return z?z.then(w):Promise.resolve(t)}return Promise.resolve(null).then(w)}e.sequence=o;function m(l,t=a=>!!a,i=null){let a=0;const u=l.length,w=()=>{if(a>=u)return Promise.resolve(i);const B=l[a++];return Promise.resolve(B()).then(V=>t(V)?Promise.resolve(V):w())};return w()}e.first=m;function b(l,t=a=>!!a,i=null){if(l.length===0)return Promise.resolve(i);let a=l.length;const u=()=>{a=-1;for(const w of l)w.cancel?.()};return new Promise((w,B)=>{for(const z of l)z.then(V=>{--a>=0&&t(V)?(u(),w(V)):a===0&&w(i)}).catch(V=>{--a>=0&&(u(),B(V))})})}e.firstParallel=b;class M{constructor(t){this._size=0,this.maxDegreeOfParalellism=t,this.outstandingPromises=[],this.runningPromises=0,this._onDrained=new R.Emitter}get onDrained(){return this._onDrained.event}get size(){return this._size}queue(t){return this._size++,new Promise((i,a)=>{this.outstandingPromises.push({factory:t,c:i,e:a}),this.consume()})}consume(){for(;this.outstandingPromises.length&&this.runningPromises<this.maxDegreeOfParalellism;){const t=this.outstandingPromises.shift();this.runningPromises++;const i=t.factory();i.then(t.c,t.e),i.then(()=>this.consumed(),()=>this.consumed())}}consumed(){this._size--,this.runningPromises--,this.outstandingPromises.length>0?this.consume():this._onDrained.fire()}dispose(){this._onDrained.dispose()}}e.Limiter=M;class W extends M{constructor(){super(1)}}e.Queue=W;class F{constructor(){this.queues=new Map,this.drainers=new Set}async whenDrained(){if(this.isDrained())return;const t=new f;return this.drainers.add(t),t.p}isDrained(){for(const[,t]of this.queues)if(t.size>0)return!1;return!0}queueFor(t,i=y.extUri){const a=i.getComparisonKey(t);let u=this.queues.get(a);return u||(u=new W,R.Event.once(u.onDrained)(()=>{u?.dispose(),this.queues.delete(a),this.onDidQueueDrain()}),this.queues.set(a,u)),u}onDidQueueDrain(){!this.isDrained()||this.releaseDrainers()}releaseDrainers(){for(const t of this.drainers)t.complete();this.drainers.clear()}dispose(){for(const[,t]of this.queues)t.dispose();this.queues.clear(),this.releaseDrainers()}}e.ResourceQueue=F;class G{constructor(t,i){this._token=-1,typeof t=="function"&&typeof i=="number"&&this.setIfNotSet(t,i)}dispose(){this.cancel()}cancel(){this._token!==-1&&(clearTimeout(this._token),this._token=-1)}cancelAndSet(t,i){this.cancel(),this._token=setTimeout(()=>{this._token=-1,t()},i)}setIfNotSet(t,i){this._token===-1&&(this._token=setTimeout(()=>{this._token=-1,t()},i))}}e.TimeoutTimer=G;class te{constructor(){this._token=-1}dispose(){this.cancel()}cancel(){this._token!==-1&&(clearInterval(this._token),this._token=-1)}cancelAndSet(t,i){this.cancel(),this._token=setInterval(()=>{t()},i)}}e.IntervalTimer=te;class X{constructor(t,i){this.timeoutToken=-1,this.runner=t,this.timeout=i,this.timeoutHandler=this.onTimeout.bind(this)}dispose(){this.cancel(),this.runner=null}cancel(){this.isScheduled()&&(clearTimeout(this.timeoutToken),this.timeoutToken=-1)}schedule(t=this.timeout){this.cancel(),this.timeoutToken=setTimeout(this.timeoutHandler,t)}get delay(){return this.timeout}set delay(t){this.timeout=t}isScheduled(){return this.timeoutToken!==-1}onTimeout(){this.timeoutToken=-1,this.runner&&this.doRun()}doRun(){this.runner?.()}}e.RunOnceScheduler=X;class J{constructor(t,i){i%1e3!==0&&console.warn(`ProcessTimeRunOnceScheduler resolution is 1s, ${i}ms is not a multiple of 1000ms.`),this.runner=t,this.timeout=i,this.counter=0,this.intervalToken=-1,this.intervalHandler=this.onInterval.bind(this)}dispose(){this.cancel(),this.runner=null}cancel(){this.isScheduled()&&(clearInterval(this.intervalToken),this.intervalToken=-1)}schedule(t=this.timeout){t%1e3!==0&&console.warn(`ProcessTimeRunOnceScheduler resolution is 1s, ${t}ms is not a multiple of 1000ms.`),this.cancel(),this.counter=Math.ceil(t/1e3),this.intervalToken=setInterval(this.intervalHandler,1e3)}isScheduled(){return this.intervalToken!==-1}onInterval(){this.counter--,!(this.counter>0)&&(clearInterval(this.intervalToken),this.intervalToken=-1,this.runner?.())}}e.ProcessTimeRunOnceScheduler=J;class Z extends X{constructor(t,i){super(t,i),this.units=[]}work(t){this.units.push(t),this.isScheduled()||this.schedule()}doRun(){const t=this.units;this.units=[],this.runner?.(t)}dispose(){this.units=[],super.dispose()}}e.RunOnceWorker=Z;class se extends I.Disposable{constructor(t,i){super(),this.options=t,this.handler=i,this.pendingWork=[],this.throttler=this._register(new I.MutableDisposable),this.disposed=!1}get pending(){return this.pendingWork.length}work(t){if(this.disposed)return!1;if(typeof this.options.maxBufferedWork=="number"){if(this.throttler.value){if(this.pending+t.length>this.options.maxBufferedWork)return!1}else if(this.pending+t.length-this.options.maxWorkChunkSize>this.options.maxBufferedWork)return!1}return this.pendingWork.push(...t),this.throttler.value||this.doWork(),!0}doWork(){this.handler(this.pendingWork.splice(0,this.options.maxWorkChunkSize)),this.pendingWork.length>0&&(this.throttler.value=new X(()=>{this.throttler.clear(),this.doWork()},this.options.throttleDelay),this.throttler.value.schedule())}dispose(){super.dispose(),this.disposed=!0}}e.ThrottledWorker=se,function(){typeof requestIdleCallback!="function"||typeof cancelIdleCallback!="function"?e.runWhenIdle=l=>{(0,U.setTimeout0)(()=>{if(t)return;const i=Date.now()+15;l(Object.freeze({didTimeout:!0,timeRemaining(){return Math.max(0,i-Date.now())}}))});let t=!1;return{dispose(){t||(t=!0)}}}:e.runWhenIdle=(l,t)=>{const i=requestIdleCallback(l,typeof t=="number"?{timeout:t}:void 0);let a=!1;return{dispose(){a||(a=!0,cancelIdleCallback(i))}}}}();class ${constructor(t){this._didRun=!1,this._executor=()=>{try{this._value=t()}catch(i){this._error=i}finally{this._didRun=!0}},this._handle=(0,e.runWhenIdle)(()=>this._executor())}dispose(){this._handle.dispose()}get value(){if(this._didRun||(this._handle.dispose(),this._executor()),this._error)throw this._error;return this._value}get isInitialized(){return this._didRun}}e.IdleValue=$;async function K(l,t,i){let a;for(let u=0;u<i;u++)try{return await l()}catch(w){a=w,await L(t)}throw a}e.retry=K;class H{hasPending(t){return this._pending?typeof t=="number"?this._pending.taskId===t:!!this._pending:!1}get pending(){return this._pending?.promise}cancelPending(){this._pending?.cancel()}setPending(t,i,a){return this._pending={taskId:t,cancel:()=>a?.(),promise:i},i.then(()=>this.donePending(t),()=>this.donePending(t)),i}donePending(t){this._pending&&t===this._pending.taskId&&(this._pending=void 0,this.triggerNext())}triggerNext(){if(this._next){const t=this._next;this._next=void 0,t.run().then(t.promiseResolve,t.promiseReject)}}setNext(t){if(this._next)this._next.run=t;else{let i,a;const u=new Promise((w,B)=>{i=w,a=B});this._next={run:t,promise:u,promiseResolve:i,promiseReject:a}}return this._next.promise}hasNext(){return!!this._next}async join(){return this._next?.promise??this._pending?.promise}}e.TaskSequentializer=H;class x{constructor(t,i=()=>Date.now()){this.interval=t,this.nowFn=i,this.lastIncrementTime=0,this.value=0}increment(){const t=this.nowFn();return t-this.lastIncrementTime>this.interval&&(this.lastIncrementTime=t,this.value=0),this.value++,this.value}}e.IntervalCounter=x;class f{get isRejected(){return this.rejected}get isResolved(){return this.resolved}get isSettled(){return this.rejected||this.resolved}constructor(){this.rejected=!1,this.resolved=!1,this.p=new Promise((t,i)=>{this.completeCallback=t,this.errorCallback=i})}complete(t){return new Promise(i=>{this.completeCallback(t),this.resolved=!0,i()})}error(t){return new Promise(i=>{this.errorCallback(t),this.rejected=!0,i()})}cancel(){new Promise(t=>{this.errorCallback(new D.CancellationError),this.rejected=!0,t()})}}e.DeferredPromise=f;var g;(function(l){async function t(a){let u;const w=await Promise.all(a.map(B=>B.then(z=>z,z=>{u||(u=z)})));if(typeof u<"u")throw u;return w}l.settled=t;function i(a){return new Promise(async(u,w)=>{try{await a(u,w)}catch(B){w(B)}})}l.withAsyncBody=i})(g=e.Promises||(e.Promises={}));var c;(function(l){l[l.Initial=0]="Initial",l[l.DoneOK=1]="DoneOK",l[l.DoneError=2]="DoneError"})(c||(c={}));class P{static fromArray(t){return new P(i=>{i.emitMany(t)})}static fromPromise(t){return new P(async i=>{i.emitMany(await t)})}static fromPromises(t){return new P(async i=>{await Promise.all(t.map(async a=>i.emitOne(await a)))})}static merge(t){return new P(async i=>{await Promise.all(t.map(async a=>{for await(const u of a)i.emitOne(u)}))})}constructor(t){this._state=0,this._results=[],this._error=null,this._onStateChanged=new R.Emitter,queueMicrotask(async()=>{const i={emitOne:a=>this.emitOne(a),emitMany:a=>this.emitMany(a),reject:a=>this.reject(a)};try{await Promise.resolve(t(i)),this.resolve()}catch(a){this.reject(a)}finally{i.emitOne=void 0,i.emitMany=void 0,i.reject=void 0}})}[Symbol.asyncIterator](){let t=0;return{next:async()=>{do{if(this._state===2)throw this._error;if(t<this._results.length)return{done:!1,value:this._results[t++]};if(this._state===1)return{done:!0,value:void 0};await R.Event.toPromise(this._onStateChanged.event)}while(!0)}}}static map(t,i){return new P(async a=>{for await(const u of t)a.emitOne(i(u))})}map(t){return P.map(this,t)}static filter(t,i){return new P(async a=>{for await(const u of t)i(u)&&a.emitOne(u)})}filter(t){return P.filter(this,t)}static coalesce(t){return P.filter(t,i=>!!i)}coalesce(){return P.coalesce(this)}static async toPromise(t){const i=[];for await(const a of t)i.push(a);return i}toPromise(){return P.toPromise(this)}emitOne(t){this._state===0&&(this._results.push(t),this._onStateChanged.fire())}emitMany(t){this._state===0&&(this._results=this._results.concat(t),this._onStateChanged.fire())}resolve(){this._state===0&&(this._state=1,this._onStateChanged.fire())}reject(t){this._state===0&&(this._state=2,this._error=t,this._onStateChanged.fire())}}e.AsyncIterableObject=P,P.EMPTY=P.fromArray([]);class k extends P{constructor(t,i){super(i),this._source=t}cancel(){this._source.cancel()}}e.CancelableAsyncIterableObject=k;function O(l){const t=new E.CancellationTokenSource,i=l(t.token);return new k(t,async a=>{const u=t.token.onCancellationRequested(()=>{u.dispose(),t.dispose(),a.reject(new D.CancellationError)});try{for await(const w of i){if(t.token.isCancellationRequested)return;a.emitOne(w)}u.dispose(),t.dispose()}catch(w){u.dispose(),t.dispose(),a.reject(w)}})}e.createCancelableAsyncIterable=O}),define(ne[9],ie([0,1,19,8,5,10,3,2,4]),function(ee,e,E,D,R,I,y,U,d){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.patternsEquals=e.getPathTerms=e.getBasenameTerms=e.isRelativePattern=e.parse=e.match=e.splitGlobAware=e.GLOB_SPLIT=e.GLOBSTAR=e.getEmptyExpression=void 0;function _(){return Object.create(null)}e.getEmptyExpression=_,e.GLOBSTAR="**",e.GLOB_SPLIT="/";const S="[/\\\\]",A="[^/\\\\]",j=/\//g;function p(f,g){switch(f){case 0:return"";case 1:return`${A}*?`;default:return`(?:${S}|${A}+${S}${g?`|${S}${A}+`:""})*?`}}function s(f,g){if(!f)return[];const c=[];let P=!1,k=!1,O="";for(const l of f){switch(l){case g:if(!P&&!k){c.push(O),O="";continue}break;case"{":P=!0;break;case"}":P=!1;break;case"[":k=!0;break;case"]":k=!1;break}O+=l}return O&&c.push(O),c}e.splitGlobAware=s;function n(f){if(!f)return"";let g="";const c=s(f,e.GLOB_SPLIT);if(c.every(P=>P===e.GLOBSTAR))g=".*";else{let P=!1;c.forEach((k,O)=>{if(k===e.GLOBSTAR){if(P)return;g+=p(2,O===c.length-1)}else{let l=!1,t="",i=!1,a="";for(const u of k){if(u!=="}"&&l){t+=u;continue}if(i&&(u!=="]"||!a)){let w;u==="-"?w=u:(u==="^"||u==="!")&&!a?w="^":u===e.GLOB_SPLIT?w="":w=(0,d.escapeRegExpCharacters)(u),a+=w;continue}switch(u){case"{":l=!0;continue;case"[":i=!0;continue;case"}":{g+=`(?:${s(t,",").map(z=>n(z)).join("|")})`,l=!1,t="";break}case"]":{g+="["+a+"]",i=!1,a="";break}case"?":g+=A;continue;case"*":g+=p(1);continue;default:g+=(0,d.escapeRegExpCharacters)(u)}}O<c.length-1&&(c[O+1]!==e.GLOBSTAR||O+2<c.length)&&(g+=S)}P=k===e.GLOBSTAR})}return g}const r=/^\*\*\/\*\.[\w\.-]+$/,h=/^\*\*\/([\w\.-]+)\/?$/,v=/^{\*\*\/\*?[\w\.-]+\/?(,\*\*\/\*?[\w\.-]+\/?)*}$/,T=/^{\*\*\/\*?[\w\.-]+(\/(\*\*)?)?(,\*\*\/\*?[\w\.-]+(\/(\*\*)?)?)*}$/,N=/^\*\*((\/[\w\.-]+)+)\/?$/,Y=/^([\w\.-]+(\/[\w\.-]+)*)\/?$/,C=new I.LRUCache(1e4),q=function(){return!1},L=function(){return null};function Q(f,g){if(!f)return L;let c;typeof f!="string"?c=f.pattern:c=f,c=c.trim();const P=`${c}_${!!g.trimForExclusions}`;let k=C.get(P);if(k)return o(k,f);let O;return r.test(c)?k=b(c.substr(4),c):(O=h.exec(m(c,g)))?k=M(O[1],c):(g.trimForExclusions?T:v).test(c)?k=W(c,g):(O=N.exec(m(c,g)))?k=F(O[1].substr(1),c,!0):(O=Y.exec(m(c,g)))?k=F(O[1],c,!1):k=G(c),C.set(P,k),o(k,f)}function o(f,g){if(typeof g=="string")return f;const c=function(P,k){return(0,R.isEqualOrParent)(P,g.base,!U.isLinux)?f(P.substr(g.base.length+1),k):null};return c.allBasenames=f.allBasenames,c.allPaths=f.allPaths,c.basenames=f.basenames,c.patterns=f.patterns,c}function m(f,g){return g.trimForExclusions&&f.endsWith("/**")?f.substr(0,f.length-2):f}function b(f,g){return function(c,P){return typeof c=="string"&&c.endsWith(f)?g:null}}function M(f,g){const c=`/${f}`,P=`\\${f}`,k=function(l,t){return typeof l!="string"?null:t?t===f?g:null:l===f||l.endsWith(c)||l.endsWith(P)?g:null},O=[f];return k.basenames=O,k.patterns=[g],k.allBasenames=O,k}function W(f,g){const c=H(f.slice(1,-1).split(",").map(t=>Q(t,g)).filter(t=>t!==L),f),P=c.length;if(!P)return L;if(P===1)return c[0];const k=function(t,i){for(let a=0,u=c.length;a<u;a++)if(c[a](t,i))return f;return null},O=c.find(t=>!!t.allBasenames);O&&(k.allBasenames=O.allBasenames);const l=c.reduce((t,i)=>i.allPaths?t.concat(i.allPaths):t,[]);return l.length&&(k.allPaths=l),k}function F(f,g,c){const P=y.sep===y.posix.sep,k=P?f:f.replace(j,y.sep),O=y.sep+k,l=y.posix.sep+f;let t;return c?t=function(i,a){return typeof i=="string"&&(i===k||i.endsWith(O)||!P&&(i===f||i.endsWith(l)))?g:null}:t=function(i,a){return typeof i=="string"&&(i===k||!P&&i===f)?g:null},t.allPaths=[(c?"*/":"./")+f],t}function G(f){try{const g=new RegExp(`^${n(f)}$`);return function(c){return g.lastIndex=0,typeof c=="string"&&g.test(c)?f:null}}catch{return L}}function te(f,g,c){return!f||typeof g!="string"?!1:X(f)(g,void 0,c)}e.match=te;function X(f,g={}){if(!f)return q;if(typeof f=="string"||J(f)){const c=Q(f,g);if(c===L)return q;const P=function(k,O){return!!c(k,O)};return c.allBasenames&&(P.allBasenames=c.allBasenames),c.allPaths&&(P.allPaths=c.allPaths),P}return $(f,g)}e.parse=X;function J(f){const g=f;return g?typeof g.base=="string"&&typeof g.pattern=="string":!1}e.isRelativePattern=J;function Z(f){return f.allBasenames||[]}e.getBasenameTerms=Z;function se(f){return f.allPaths||[]}e.getPathTerms=se;function $(f,g){const c=H(Object.getOwnPropertyNames(f).map(t=>K(t,f[t],g)).filter(t=>t!==L)),P=c.length;if(!P)return L;if(!c.some(t=>!!t.requiresSiblings)){if(P===1)return c[0];const t=function(u,w){let B;for(let z=0,V=c.length;z<V;z++){const re=c[z](u,w);if(typeof re=="string")return re;(0,D.isThenable)(re)&&(B||(B=[]),B.push(re))}return B?(async()=>{for(const z of B){const V=await z;if(typeof V=="string")return V}return null})():null},i=c.find(u=>!!u.allBasenames);i&&(t.allBasenames=i.allBasenames);const a=c.reduce((u,w)=>w.allPaths?u.concat(w.allPaths):u,[]);return a.length&&(t.allPaths=a),t}const k=function(t,i,a){let u,w;for(let B=0,z=c.length;B<z;B++){const V=c[B];V.requiresSiblings&&a&&(i||(i=(0,y.basename)(t)),u||(u=i.substr(0,i.length-(0,y.extname)(t).length)));const re=V(t,i,u,a);if(typeof re=="string")return re;(0,D.isThenable)(re)&&(w||(w=[]),w.push(re))}return w?(async()=>{for(const B of w){const z=await B;if(typeof z=="string")return z}return null})():null},O=c.find(t=>!!t.allBasenames);O&&(k.allBasenames=O.allBasenames);const l=c.reduce((t,i)=>i.allPaths?t.concat(i.allPaths):t,[]);return l.length&&(k.allPaths=l),k}function K(f,g,c){if(g===!1)return L;const P=Q(f,c);if(P===L)return L;if(typeof g=="boolean")return P;if(g){const k=g.when;if(typeof k=="string"){const O=(l,t,i,a)=>{if(!a||!P(l,t))return null;const u=k.replace("$(basename)",i),w=a(u);return(0,D.isThenable)(w)?w.then(B=>B?f:null):w?f:null};return O.requiresSiblings=!0,O}}return P}function H(f,g){const c=f.filter(t=>!!t.basenames);if(c.length<2)return f;const P=c.reduce((t,i)=>{const a=i.basenames;return a?t.concat(a):t},[]);let k;if(g){k=[];for(let t=0,i=P.length;t<i;t++)k.push(g)}else k=c.reduce((t,i)=>{const a=i.patterns;return a?t.concat(a):t},[]);const O=function(t,i){if(typeof t!="string")return null;if(!i){let u;for(u=t.length;u>0;u--){const w=t.charCodeAt(u-1);if(w===47||w===92)break}i=t.substr(u)}const a=P.indexOf(i);return a!==-1?k[a]:null};O.basenames=P,O.patterns=k,O.allBasenames=P;const l=f.filter(t=>!t.basenames);return l.push(O),l}function x(f,g){return(0,E.equals)(f,g,(c,P)=>typeof c=="string"&&typeof P=="string"?c===P:typeof c!="string"&&typeof P!="string"?c.base===P.base&&c.pattern===P.pattern:!1)}e.patternsEquals=x}),define(ne[13],ie([0,1,20]),function(ee,e,E){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.getFileResults=void 0;const D=(R,I,y)=>{let U;if(R[0]===255&&R[1]===254)U=new TextDecoder("utf-16le").decode(R);else if(R[0]===254&&R[1]===255)U=new TextDecoder("utf-16be").decode(R);else if(U=new TextDecoder("utf8").decode(R),U.slice(0,1e3).includes("\uFFFD")&&R.includes(0))return[];const d=[],_=[];let S=null,A=y.remainingResultQuota;for(;A>=0&&(S=I.exec(U));)_.push({matchStartIndex:S.index,matchedText:S[0]}),A--;if(_.length){const j=new Set,p=new Set,s=[],n=N=>U.slice(s[N].start,s[N].end);let r=0,h=null;const v=/\r?\n/g;for(;h=v.exec(U);)s.push({start:r,end:h.index}),r=h.index+h[0].length;r<U.length&&s.push({start:r,end:U.length});let T=0;for(const{matchStartIndex:N,matchedText:Y}of _){if(A<0)break;for(;Boolean(s[T+1])&&N>s[T].end;)T++;let C=T;for(;Boolean(s[C+1])&&N+Y.length>s[C].end;)C++;if(y.beforeContext)for(let b=Math.max(0,T-y.beforeContext);b<T;b++)j.add(b);let q="",L=0;for(let b=T;b<=C;b++){let M=n(b);y.previewOptions?.charsPerLine&&M.length>y.previewOptions.charsPerLine&&(L=Math.max(N-s[T].start-20,0),M=M.substr(L,y.previewOptions.charsPerLine)),q+=`${M}
`,p.add(b)}const Q=new E.Range(T,N-s[T].start,C,N+Y.length-s[C].start),o=new E.Range(0,N-s[T].start-L,C-T,N+Y.length-s[C].start-(C===T?L:0)),m={ranges:Q,preview:{text:q,matches:o}};if(d.push(m),y.afterContext)for(let b=C+1;b<=Math.min(C+y.afterContext,s.length-1);b++)j.add(b)}for(const N of j)p.has(N)||d.push({text:n(N),lineNumber:N+1})}return d};e.getFileResults=D}),define(ne[14],ie([0,1,9]),function(ee,e,E){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.IgnoreFile=void 0;class D{constructor(I,y,U){if(this.location=y,this.parent=U,y[y.length-1]==="\\")throw Error("Unexpected path format, do not use trailing backslashes");y[y.length-1]!=="/"&&(y+="/"),this.isPathIgnored=this.parseIgnoreFile(I,this.location,this.parent)}updateContents(I){this.isPathIgnored=this.parseIgnoreFile(I,this.location,this.parent)}isPathIncludedInTraversal(I,y){if(I[0]!=="/"||I[I.length-1]==="/")throw Error("Unexpected path format, expectred to begin with slash and end without. got:"+I);return!this.isPathIgnored(I,y)}isArbitraryPathIgnored(I,y){if(I[0]!=="/"||I[I.length-1]==="/")throw Error("Unexpected path format, expectred to begin with slash and end without. got:"+I);const U=I.split("/").filter(S=>S);let d=!1,_="";for(let S=0;S<U.length;S++){const A=S===U.length-1,j=U[S];if(_=_+"/"+j,!this.isPathIncludedInTraversal(_,A?y:!0)){d=!0;break}}return d}gitignoreLinesToExpression(I,y,U){const d=I.map(S=>this.gitignoreLineToGlob(S,y)),_=Object.create(null);for(const S of d)_[S]=!0;return E.parse(_,{trimForExclusions:U})}parseIgnoreFile(I,y,U){const d=I.split(`
`).map(T=>T.trim()).filter(T=>T&&T[0]!=="#"),_=d.filter(T=>!T.endsWith("/")),S=_.filter(T=>!T.includes("!")),A=this.gitignoreLinesToExpression(S,y,!0),j=_.filter(T=>T.includes("!")).map(T=>T.replace(/!/g,"")),p=this.gitignoreLinesToExpression(j,y,!1),s=d.filter(T=>!T.includes("!")),n=this.gitignoreLinesToExpression(s,y,!0),r=d.filter(T=>T.includes("!")).map(T=>T.replace(/!/g,"")),h=this.gitignoreLinesToExpression(r,y,!1);return(T,N)=>T.startsWith(y)?N&&n(T)&&!h(T)||A(T)&&!p(T)?!0:U?U.isPathIgnored(T,N):!1:!1}gitignoreLineToGlob(I,y){const U=I.indexOf("/");return U===-1||U===I.length-1?I="**/"+I:(U===0?y.slice(-1)==="/"&&(I=I.slice(1)):y.slice(-1)!=="/"&&(I="/"+I),I=y+I),I}}e.IgnoreFile=D}),define(ne[21],ie([0,1,9,6,3,12,13,14,4,8,7]),function(ee,e,E,D,R,I,y,U,d,_,S){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.LocalFileSearchSimpleWorker=e.create=void 0;const A=!1,j=+new Date,p={},s=async(C,q)=>{if(!A)return q();const L=Date.now(),Q=(p[C]??0)+1;console.info(C,Q,"starting",Math.round((L-j)*10)/1e4),p[C]=Q;const o=await q(),m=Date.now();return console.info(C,Q,"took",m-L),o};function n(C){return new r(C)}e.create=n;class r{constructor(q){this.host=q,this.cancellationTokens=new Map}cancelQuery(q){this.cancellationTokens.get(q)?.cancel()}registerCancellationToken(q){const L=new I.CancellationTokenSource;return this.cancellationTokens.set(q,L),L}async listDirectory(q,L,Q,o,m){const b=v(Q),M=new S.ExtUri(()=>o),W=this.registerCancellationToken(m),F=[];let G=!1,te=0;const X=L.maxResults||512,J=L.filePattern?Z=>L.filePattern.split("").every(se=>Z.includes(se)):Z=>!0;return await s("listDirectory",()=>this.walkFolderQuery(q,T(L),b,M,Z=>{if(!!J(Z.name))return te++,X&&te>X&&(G=!0,W.cancel()),F.push(Z.path)},W.token)),{results:F,limitHit:G}}async searchDirectory(q,L,Q,o,m){const b=v(Q),M=new S.ExtUri(()=>o);return s("searchInFiles",async()=>{const W=this.registerCancellationToken(m),F=[],G=h(L.contentPattern),te=[];let X=0,J=0;const Z=!1,se=async $=>{if(W.token.isCancellationRequested)return;X++;const K=await $.resolve();if(W.token.isCancellationRequested)return;const H=new Uint8Array(K),x=(0,y.getFileResults)(H,G,{afterContext:L.afterContext??0,beforeContext:L.beforeContext??0,previewOptions:L.previewOptions,remainingResultQuota:L.maxResults?L.maxResults-J:1e4});if(x.length){J+=x.length,L.maxResults&&J>L.maxResults&&W.cancel();const f={resource:D.URI.joinPath(b.folder,$.path),results:x};this.host.sendTextSearchMatch(f,m),F.push(f)}};return await s("walkFolderToResolve",()=>this.walkFolderQuery(q,T(L),b,M,async $=>te.push(se($)),W.token)),await s("resolveOngoingProcesses",()=>Promise.all(te)),A&&console.log("Searched in",X,"files"),{results:F,limitHit:Z}})}async walkFolderQuery(q,L,Q,o,m,b){const M=E.parse(Q.excludePattern??{},{trimForExclusions:!0}),W=($,K,H)=>($=$.slice(1),!!(M($,K,H)||N(L,$))),F=($,K,H)=>($=$.slice(1),!(M($,K,H)||!Y(L,$,o))),G=($,K)=>({type:"file",name:$.name,path:K,resolve:()=>$.getFile().then(x=>x.arrayBuffer())}),te=$=>$.kind==="directory",X=$=>$.kind==="file",J=async($,K,H)=>{if(!Q.disregardIgnoreFiles){const f=await Promise.all([$.getFileHandle(".gitignore").catch(g=>{}),$.getFileHandle(".ignore").catch(g=>{})]);await Promise.all(f.map(async g=>{if(!g)return;const c=new TextDecoder("utf8").decode(new Uint8Array(await(await g.getFile()).arrayBuffer()));H=new U.IgnoreFile(c,K,H)}))}const x=_.Promises.withAsyncBody(async f=>{const g=[],c=[],P=[],k=new Set;for await(const O of $.entries())P.push(O),k.add(O[0]);for(const[O,l]of P){if(b.isCancellationRequested)break;const t=K+O;if(H&&!H.isPathIncludedInTraversal(t,l.kind==="directory"))continue;const i=a=>k.has(a);te(l)&&!W(t,O,i)?c.push(J(l,t+"/",H)):X(l)&&F(t,O,i)&&g.push(G(l,t))}f([...await Promise.all(c),...g])});return{type:"dir",name:$.name,entries:x}},Z=async($,K)=>{b.isCancellationRequested||await Promise.all((await $.entries).sort((H,x)=>-(H.type==="dir"?0:1)+(x.type==="dir"?0:1)).map(async H=>H.type==="dir"?Z(H,K):K(H)))},se=await s("process",()=>J(q,"/"));await s("resolve",()=>Z(se,m))}}e.LocalFileSearchSimpleWorker=r;function h(C){return(0,d.createRegExp)(C.pattern,!!C.isRegExp,{wholeWord:C.isWordMatch,global:!0,matchCase:C.isCaseSensitive,multiline:!0,unicode:!0})}function v(C){return{...C,folder:D.URI.revive(C.folder)}}function T(C){return{...C,extraFileResources:C.extraFileResources?.map(q=>D.URI.revive(q)),folderQueries:C.folderQueries.map(q=>v(q))}}function N(C,q){return!!(C.excludePattern&&E.match(C.excludePattern,q))}function Y(C,q,L){return C.excludePattern&&E.match(C.excludePattern,q)?!1:C.includePattern||C.usingSearchPaths?C.includePattern&&E.match(C.includePattern,q)?!0:C.usingSearchPaths?!!C.folderQueries&&C.folderQueries.some(Q=>{const o=Q.folder,m=D.URI.file(q);if(L.isEqualOrParent(m,o)){const b=R.relative(o.path,m.path);return!Q.includePattern||!!E.match(Q.includePattern,b)}else return!1}):!1:!0}})}).call(this);

//# sourceMappingURL=https://ticino.blob.core.windows.net/sourcemaps/6261075646f055b99068d3688932416f2346dd3b/core/vs/workbench/services/search/worker/localFileSearch.js.map
