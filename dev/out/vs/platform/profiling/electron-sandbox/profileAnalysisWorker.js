/*!--------------------------------------------------------
 * Copyright (C) Microsoft Corporation. All rights reserved.
 *--------------------------------------------------------*/(function(){var S=["require","exports","vs/base/common/ternarySearchTree","vs/platform/instantiation/common/instantiation","vs/platform/profiling/common/profiling","vs/base/common/path","vs/platform/profiling/common/profilingModel","vs/base/common/arrays","vs/base/common/strings","vs/platform/profiling/electron-sandbox/profileAnalysisWorker","vs/base/common/uri"],k=function(y){for(var h=[],b=0,p=y.length;b<p;b++)h[b]=S[y[b]];return h};define(S[2],k([0,1,7,8]),function(y,h,b,p){"use strict";Object.defineProperty(h,"__esModule",{value:!0}),h.TernarySearchTree=h.UriIterator=h.PathIterator=h.ConfigKeysIterator=h.StringIterator=void 0;class I{constructor(){this.b="",this.c=0}reset(e){return this.b=e,this.c=0,this}next(){return this.c+=1,this}hasNext(){return this.c<this.b.length-1}cmp(e){const i=e.charCodeAt(0),s=this.b.charCodeAt(this.c);return i-s}value(){return this.b[this.c]}}h.StringIterator=I;class v{constructor(e=!0){this.e=e}reset(e){return this.b=e,this.c=0,this.d=0,this.next()}hasNext(){return this.d<this.b.length}next(){this.c=this.d;let e=!0;for(;this.d<this.b.length;this.d++)if(this.b.charCodeAt(this.d)===46)if(e)this.c++;else break;else e=!1;return this}cmp(e){return this.e?(0,p.compareSubstring)(e,this.b,0,e.length,this.c,this.d):(0,p.compareSubstringIgnoreCase)(e,this.b,0,e.length,this.c,this.d)}value(){return this.b.substring(this.c,this.d)}}h.ConfigKeysIterator=v;class m{constructor(e=!0,i=!0){this.f=e,this.g=i}reset(e){this.d=0,this.e=0,this.b=e,this.c=e.length;for(let i=e.length-1;i>=0;i--,this.c--){const s=this.b.charCodeAt(i);if(!(s===47||this.f&&s===92))break}return this.next()}hasNext(){return this.e<this.c}next(){this.d=this.e;let e=!0;for(;this.e<this.c;this.e++){const i=this.b.charCodeAt(this.e);if(i===47||this.f&&i===92)if(e)this.d++;else break;else e=!1}return this}cmp(e){return this.g?(0,p.compareSubstring)(e,this.b,0,e.length,this.d,this.e):(0,p.compareSubstringIgnoreCase)(e,this.b,0,e.length,this.d,this.e)}value(){return this.b.substring(this.d,this.e)}}h.PathIterator=m;var a;(function(c){c[c.Scheme=1]="Scheme",c[c.Authority=2]="Authority",c[c.Path=3]="Path",c[c.Query=4]="Query",c[c.Fragment=5]="Fragment"})(a||(a={}));class u{constructor(e,i){this.f=e,this.g=i,this.d=[],this.e=0}reset(e){return this.c=e,this.d=[],this.c.scheme&&this.d.push(1),this.c.authority&&this.d.push(2),this.c.path&&(this.b=new m(!1,!this.f(e)),this.b.reset(e.path),this.b.value()&&this.d.push(3)),this.g(e)||(this.c.query&&this.d.push(4),this.c.fragment&&this.d.push(5)),this.e=0,this}next(){return this.d[this.e]===3&&this.b.hasNext()?this.b.next():this.e+=1,this}hasNext(){return this.d[this.e]===3&&this.b.hasNext()||this.e<this.d.length-1}cmp(e){if(this.d[this.e]===1)return(0,p.compareIgnoreCase)(e,this.c.scheme);if(this.d[this.e]===2)return(0,p.compareIgnoreCase)(e,this.c.authority);if(this.d[this.e]===3)return this.b.cmp(e);if(this.d[this.e]===4)return(0,p.compare)(e,this.c.query);if(this.d[this.e]===5)return(0,p.compare)(e,this.c.fragment);throw new Error}value(){if(this.d[this.e]===1)return this.c.scheme;if(this.d[this.e]===2)return this.c.authority;if(this.d[this.e]===3)return this.b.value();if(this.d[this.e]===4)return this.c.query;if(this.d[this.e]===5)return this.c.fragment;throw new Error}}h.UriIterator=u;class f{constructor(){this.height=1}isEmpty(){return!this.left&&!this.mid&&!this.right&&!this.value}rotateLeft(){const e=this.right;return this.right=e.left,e.left=this,this.updateHeight(),e.updateHeight(),e}rotateRight(){const e=this.left;return this.left=e.right,e.right=this,this.updateHeight(),e.updateHeight(),e}updateHeight(){this.height=1+Math.max(this.heightLeft,this.heightRight)}balanceFactor(){return this.heightRight-this.heightLeft}get heightLeft(){return this.left?.height??0}get heightRight(){return this.right?.height??0}}var g;(function(c){c[c.Left=-1]="Left",c[c.Mid=0]="Mid",c[c.Right=1]="Right"})(g||(g={}));class l{static forUris(e=()=>!1,i=()=>!1){return new l(new u(e,i))}static forPaths(e=!1){return new l(new m(void 0,!e))}static forStrings(){return new l(new I)}static forConfigKeys(){return new l(new v)}constructor(e){this.b=e}clear(){this.c=void 0}fill(e,i){if(i){const s=i.slice(0);(0,b.shuffle)(s);for(const r of s)this.set(r,e)}else{const s=e.slice(0);(0,b.shuffle)(s);for(const r of s)this.set(r[0],r[1])}}set(e,i){const s=this.b.reset(e);let r;this.c||(this.c=new f,this.c.segment=s.value());const t=[];for(r=this.c;;){const o=s.cmp(r.segment);if(o>0)r.left||(r.left=new f,r.left.segment=s.value()),t.push([-1,r]),r=r.left;else if(o<0)r.right||(r.right=new f,r.right.segment=s.value()),t.push([1,r]),r=r.right;else if(s.hasNext())s.next(),r.mid||(r.mid=new f,r.mid.segment=s.value()),t.push([0,r]),r=r.mid;else break}const n=r.value;r.value=i,r.key=e;for(let o=t.length-1;o>=0;o--){const d=t[o][1];d.updateHeight();const T=d.balanceFactor();if(T<-1||T>1){const N=t[o][0],w=t[o+1][0];if(N===1&&w===1)t[o][1]=d.rotateLeft();else if(N===-1&&w===-1)t[o][1]=d.rotateRight();else if(N===1&&w===-1)d.right=t[o+1][1]=t[o+1][1].rotateRight(),t[o][1]=d.rotateLeft();else if(N===-1&&w===1)d.left=t[o+1][1]=t[o+1][1].rotateLeft(),t[o][1]=d.rotateRight();else throw new Error;if(o>0)switch(t[o-1][0]){case-1:t[o-1][1].left=t[o][1];break;case 1:t[o-1][1].right=t[o][1];break;case 0:t[o-1][1].mid=t[o][1];break}else this.c=t[0][1]}}return n}get(e){return this.d(e)?.value}d(e){const i=this.b.reset(e);let s=this.c;for(;s;){const r=i.cmp(s.segment);if(r>0)s=s.left;else if(r<0)s=s.right;else if(i.hasNext())i.next(),s=s.mid;else break}return s}has(e){const i=this.d(e);return!(i?.value===void 0&&i?.mid===void 0)}delete(e){return this.e(e,!1)}deleteSuperstr(e){return this.e(e,!0)}e(e,i){const s=this.b.reset(e),r=[];let t=this.c;for(;t;){const n=s.cmp(t.segment);if(n>0)r.push([-1,t]),t=t.left;else if(n<0)r.push([1,t]),t=t.right;else if(s.hasNext())s.next(),r.push([0,t]),t=t.mid;else break}if(!!t){if(i?(t.left=void 0,t.mid=void 0,t.right=void 0,t.height=1):(t.key=void 0,t.value=void 0),!t.mid&&!t.value)if(t.left&&t.right){const n=this.f(t.right);if(n.key){const{key:o,value:d,segment:T}=n;this.e(n.key,!1),t.key=o,t.value=d,t.segment=T}}else{const n=t.left??t.right;if(r.length>0){const[o,d]=r[r.length-1];switch(o){case-1:d.left=n;break;case 0:d.mid=n;break;case 1:d.right=n;break}}else this.c=n}for(let n=r.length-1;n>=0;n--){const o=r[n][1];o.updateHeight();const d=o.balanceFactor();if(d>1?(o.right.balanceFactor()>=0||(o.right=o.right.rotateRight()),r[n][1]=o.rotateLeft()):d<-1&&(o.left.balanceFactor()<=0||(o.left=o.left.rotateLeft()),r[n][1]=o.rotateRight()),n>0)switch(r[n-1][0]){case-1:r[n-1][1].left=r[n][1];break;case 1:r[n-1][1].right=r[n][1];break;case 0:r[n-1][1].mid=r[n][1];break}else this.c=r[0][1]}}}f(e){for(;e.left;)e=e.left;return e}findSubstr(e){const i=this.b.reset(e);let s=this.c,r;for(;s;){const t=i.cmp(s.segment);if(t>0)s=s.left;else if(t<0)s=s.right;else if(i.hasNext())i.next(),r=s.value||r,s=s.mid;else break}return s&&s.value||r}findSuperstr(e){const i=this.b.reset(e);let s=this.c;for(;s;){const r=i.cmp(s.segment);if(r>0)s=s.left;else if(r<0)s=s.right;else if(i.hasNext())i.next(),s=s.mid;else return s.mid?this.g(s.mid):void 0}}forEach(e){for(const[i,s]of this)e(s,i)}*[Symbol.iterator](){yield*this.g(this.c)}g(e){const i=[];return this.h(e,i),i[Symbol.iterator]()}h(e,i){!e||(e.left&&this.h(e.left,i),e.value&&i.push([e.key,e.value]),e.mid&&this.h(e.mid,i),e.right&&this.h(e.right,i))}_isBalanced(){const e=i=>{if(!i)return!0;const s=i.balanceFactor();return s<-1||s>1?!1:e(i.left)&&e(i.right)};return e(this.c)}}h.TernarySearchTree=l}),define(S[3],k([0,1]),function(y,h){"use strict";Object.defineProperty(h,"__esModule",{value:!0}),h.refineServiceDecorator=h.createDecorator=h.IInstantiationService=h._util=void 0;var b;(function(m){m.serviceIds=new Map,m.DI_TARGET="$di$target",m.DI_DEPENDENCIES="$di$dependencies";function a(u){return u[m.DI_DEPENDENCIES]||[]}m.getServiceDependencies=a})(b=h._util||(h._util={})),h.IInstantiationService=I("instantiationService");function p(m,a,u){a[b.DI_TARGET]===a?a[b.DI_DEPENDENCIES].push({id:m,index:u}):(a[b.DI_DEPENDENCIES]=[{id:m,index:u}],a[b.DI_TARGET]=a)}function I(m){if(b.serviceIds.has(m))return b.serviceIds.get(m);const a=function(u,f,g){if(arguments.length!==3)throw new Error("@IServiceName-decorator can only be used to decorate a parameter");p(a,u,g)};return a.toString=()=>m,b.serviceIds.set(m,a),a}h.createDecorator=I;function v(m){return m}h.refineServiceDecorator=v}),define(S[4],k([0,1,5,3]),function(y,h,b,p){"use strict";Object.defineProperty(h,"__esModule",{value:!0}),h.Utils=h.IV8InspectProfilingService=void 0,h.IV8InspectProfilingService=(0,p.createDecorator)("IV8InspectProfilingService");var I;(function(v){function m(u){return Boolean(u.samples&&u.timeDeltas)}v.isValidProfile=m;function a(u,f="noAbsolutePaths"){for(const g of u.nodes)g.callFrame&&g.callFrame.url&&((0,b.isAbsolute)(g.callFrame.url)||/^\w[\w\d+.-]*:\/\/\/?/.test(g.callFrame.url))&&(g.callFrame.url=(0,b.join)(f,(0,b.basename)(g.callFrame.url)));return u}v.rewriteAbsolutePaths=a})(I=h.Utils||(h.Utils={}))}),define(S[6],k([0,1]),function(y,h){"use strict";Object.defineProperty(h,"__esModule",{value:!0}),h.processNode=h.BottomUpNode=h.buildModel=void 0;const b=(a,u)=>{const f=u[a];if(f.aggregateTime)return f.aggregateTime;let g=f.selfTime;for(const l of f.children)g+=b(l,u);return f.aggregateTime=g},p=a=>{let u=0;const f=new Map,g=l=>{const c=[l.functionName,l.url,l.scriptId,l.lineNumber,l.columnNumber].join(":"),e=f.get(c);if(e)return e.id;const i=u++;return f.set(c,{id:i,callFrame:l,location:{lineNumber:l.lineNumber+1,columnNumber:l.columnNumber+1}}),i};for(const l of a.nodes)l.locationId=g(l.callFrame),l.positionTicks=l.positionTicks?.map(c=>({...c,startLocationId:g({...l.callFrame,lineNumber:c.line-1,columnNumber:0}),endLocationId:g({...l.callFrame,lineNumber:c.line,columnNumber:0})}));return[...f.values()].sort((l,c)=>l.id-c.id).map(l=>({locations:[l.location],callFrame:l.callFrame}))},I=a=>{if(!a.timeDeltas||!a.samples)return{nodes:[],locations:[],samples:a.samples||[],timeDeltas:a.timeDeltas||[],duration:a.endTime-a.startTime};const{samples:u,timeDeltas:f}=a,l=p(a).map((t,n)=>{const o=t.locations[0];return{id:n,selfTime:0,aggregateTime:0,ticks:0,callFrame:t.callFrame,src:o}}),c=new Map,e=t=>{let n=c.get(t);return n===void 0&&(n=c.size,c.set(t,n)),n},i=new Array(a.nodes.length);for(let t=0;t<a.nodes.length;t++){const n=a.nodes[t],o=e(n.id);i[o]={id:o,selfTime:0,aggregateTime:0,locationId:n.locationId,children:n.children?.map(e)||[]};for(const d of n.positionTicks||[])d.startLocationId&&(l[d.startLocationId].ticks+=d.ticks)}for(const t of i)for(const n of t.children)i[n].parent=t.id;const s=a.endTime-a.startTime;let r=s-f[0];for(let t=0;t<f.length-1;t++){const n=f[t+1];i[e(u[t])].selfTime+=n,r-=n}i.length&&(i[e(u[f.length-1])].selfTime+=r,f.push(r));for(let t=0;t<i.length;t++){const n=i[t],o=l[n.locationId];o.aggregateTime+=b(t,i),o.selfTime+=n.selfTime}return{nodes:i,locations:l,samples:u.map(e),timeDeltas:f,duration:s}};h.buildModel=I;class v{static root(){return new v({id:-1,selfTime:0,aggregateTime:0,ticks:0,callFrame:{functionName:"(root)",lineNumber:-1,columnNumber:-1,scriptId:"0",url:""}})}get id(){return this.location.id}get callFrame(){return this.location.callFrame}get src(){return this.location.src}constructor(u,f){this.location=u,this.parent=f,this.children={},this.aggregateTime=0,this.selfTime=0,this.ticks=0,this.childrenSize=0}addNode(u){this.selfTime+=u.selfTime,this.aggregateTime+=u.aggregateTime}}h.BottomUpNode=v;const m=(a,u,f,g=u)=>{let l=a.children[u.locationId];l||(l=new v(f.locations[u.locationId],a),a.childrenSize++,a.children[u.locationId]=l),l.addNode(g),u.parent&&(0,h.processNode)(l,f.nodes[u.parent],f,g)};h.processNode=m}),define(S[9],k([0,1,5,2,10,4,6]),function(y,h,b,p,I,v,m){"use strict";Object.defineProperty(h,"__esModule",{value:!0}),h.create=void 0;function a(){return new u}h.create=a;class u{analyseBottomUp(e){if(!v.Utils.isValidProfile(e))return{kind:1,samples:[]};const i=(0,m.buildModel)(e),s=l(i,5,!1).filter(r=>!r.isSpecial);return s.length===0||s[1].percentage<10?{kind:1,samples:[]}:{kind:2,samples:s}}analyseByUrlCategory(e,i){const s=p.TernarySearchTree.forUris();s.fill(i);const r=(0,m.buildModel)(e),t=new Map;for(const o of r.nodes){const d=r.locations[o.locationId];let T;try{T=s.findSubstr(I.URI.parse(d.callFrame.url))}catch{}T||(T=g(d.callFrame,!1));const w=(t.get(T)??0)+o.selfTime;t.set(T,w)}const n=[];for(const[o,d]of t)n.push([o,d]);return n}}function f(c){return c.functionName.startsWith("(")&&c.functionName.endsWith(")")}function g(c,e){let i=c.functionName||"(anonymous)";return c.url&&(i+="#",i+=e?c.url:(0,b.basename)(c.url),c.lineNumber>=0&&(i+=":",i+=c.lineNumber+1)),i}function l(c,e,i=!1){const s=m.BottomUpNode.root();for(const n of c.nodes)(0,m.processNode)(s,n,c),s.addNode(n);const r=Object.values(s.children).sort((n,o)=>o.selfTime-n.selfTime).slice(0,e),t=[];for(const n of r){const o={selfTime:Math.round(n.selfTime/1e3),totalTime:Math.round(n.aggregateTime/1e3),location:g(n.callFrame,i),url:n.callFrame.url,caller:[],percentage:Math.round(n.selfTime/(c.duration/100)),isSpecial:f(n.callFrame)},d=[n];for(;d.length;){const T=d.pop();let N;for(const w of Object.values(T.children))(!N||N.selfTime<w.selfTime)&&(N=w);if(N){const w=Math.round(N.selfTime/(T.selfTime/100));o.caller.push({percentage:w,location:g(N.callFrame,!1)}),d.push(N)}}t.push(o)}return t}})}).call(this);

//# sourceMappingURL=https://ticino.blob.core.windows.net/sourcemaps/1ad8d514439d5077d2b0b7ee64d2ce82a9308e5a/core/vs/platform/profiling/electron-sandbox/profileAnalysisWorker.js.map
